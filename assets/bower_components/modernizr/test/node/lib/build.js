var root=require("find-parent-dir").sync(__dirname,"package.json"),build=require(root+"lib/build"),expect=require("expect.js");describe("cli/build",function(){it("should build without error",function(){expect(function(){build()}).to.not.throwError()}),describe("custom builds",function(done){it("should build without errors when using a custom build",function(){expect(function(){build({"feature-detects":["css/boxsizing"]},done)}).to.not.throwError()}),it("should include the requested options",function(e){build({"feature-detects":["css/boxsizing"]},function(t){expect(t).to.contain("boxsizing"),e()})}),it("should exclude options that are not requested",function(e){build({"feature-detects":["dom/classlist"]},function(t){expect(t).to.contain("classlist"),expect(t).to.not.contain("boxsizing"),e()})}),it("should strip out DOC comments when `uglify`ing",function(e){var t={minify:!0,"feature-detects":["css/boxsizing"]};build(t,function(t){expect(t).to.not.contain("Box Sizing"),e()})}),it("should inject the proper classPath when configured",function(e){var t="TEST_PREFIX",n={classPrefix:t,setClasses:!0},o=/_config:\s*?({[^}]*})/m;build(n,function(n){var i=n.match(o);i=JSON.parse(i[1].replace(/'/g,'"')),expect(i.classPrefix).to.be(t),e()})}),it("should inject the proper classPath when configured and minified",function(done){var prefix="TEST_PREFIX",config={classPrefix:prefix,setClasses:!0,minify:!0},configRE=/_config:\s*?({[^}]*})/m;build(config,function(file){var parsedConfig=file.match(configRE);parsedConfig=eval("("+parsedConfig[1].replace(/'/g,'"')+")"),expect(parsedConfig.classPrefix).to.be(prefix),done()})}),describe("unminified",function(){var e;before(function(t){var n={"feature-detects":["css/boxsizing"]};build(n,function(n){e=n,t()})}),it("strips out the modernizr-init/build `define` section",function(){var t=/define\("modernizr-(init|build)"\)/m;expect(t.test(e)).to.be(!1)}),it("strips out the `define` section",function(){var t=/define\(.*?\{/;expect(t.test(e)).to.be(!1)}),it("strips out the `require` section",function(){var t=/require[^\{\r\n]+\{/;expect(t.test(e)).to.be(!1)}),it("replaces __VERSION__ ",function(){expect(e).to.not.contain("__VERSION__")})}),describe("minified",function(){var e;before(function(t){var n={"feature-detects":["css/boxsizing"],minify:!0};build(n,function(n){e=n,t()})}),it("strips out the modernizr-init/build `define` section",function(){var t=/define\("modernizr-(init|build)"\)/m;expect(t.test(e)).to.be(!1)}),it("strips out the `define` section",function(){var t=/define\(.*?\{/;expect(t.test(e)).to.be(!1)}),it("strips out the `require` section",function(){var t=/require[^\{\r\n]+\{/;expect(t.test(e)).to.be(!1)}),it("replaces __VERSION__ ",function(){expect(e).to.not.contain("__VERSION__")})})})});