define(["lodash"],function(e){return function(t){t||(t={}),t.options=t.options||[],t["feature-detects"]=t["feature-detects"]||[];var n=e.contains(t.options,"setClasses");t.options=e.without(t.options,"setClasses");var i='require(["ModernizrProto", "Modernizr", "testRunner"';return n&&(i+=', "setClasses", "classes"'),e.includes(t.options,"html5printshiv")&&(t.options=e.without(t.options,"html5shiv")),e.forEach(t.options,function(e){i+=', "'+e+'"'}),e.forEach(t["feature-detects"],function(e){e=0===e.indexOf("test/")?e:"test/"+e,i+=', "'+e+'"'}),i+="], function( ModernizrProto, Modernizr, testRunner",n&&(i+=", setClasses, classes"),i+=") {\n  // Run each test\n  testRunner();\n\n",n&&(i+='  // Remove the "no-js" class if it exists\n  setClasses(classes);\n\n'),i+="  delete ModernizrProto.addTest;\n",i+="  delete ModernizrProto.addAsyncTest;\n\n",i+="  // Run the things that are supposed to run after the tests\n  for (var i = 0; i < Modernizr._q.length; i++) {\n    Modernizr._q[i]();\n  }\n\n",i+="  // Leak Modernizr namespace\n  window.Modernizr = Modernizr;\n\n});"}});